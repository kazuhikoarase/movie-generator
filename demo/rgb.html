<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.10/vue.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.2.2/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.min.js"></script>
    <script src="../src/movie-generator.js"></script>
    <link rel="stylesheet" href="../src/movie-generator.css" />
  </head>
  <body>

    <div id="app">


      <movie @render="renderHandler"></movie>

    </div>

    <script>

!function() {

  var createClip = function(opts) {

    return {
      render: function(event) {

        var ctx = event.ctx;
        var currentFrame = event.currentFrame;
        var numFrames = event.numFrames;
        var frameRate = event.frameRate;
        var width = event.width;
        var height = event.height;

        if (!(opts.start <= currentFrame &&
            currentFrame < opts.start + opts.length) ) {
          return;
        }

        var size = opts.size;

        ctx.save();

        ctx.translate(width / 2 + opts.x, height / 2 + opts.y);

        ctx.fillStyle = opts.color;
        ctx.fillRect(-size / 2, -size / 2, size, size);

        ctx.restore();

      }
    }
  };

  var w = 320 / 3;
  var clips = [
    createClip({ color: '#f00', start: 0, length: 24,
      x: -w, y: 0, size: w } ),
    createClip({ color: '#0f0', start: 24, length: 24,
      x: 0, y: 0, size: w } ),
    createClip({ color: '#00f', start: 48, length: 24,
      x: w, y: 0, size: w } )
  ];

  new Vue({
    el: '#app',
    methods: {

      renderHandler: function(event) {
        clips.forEach(function(clip) {
          clip.render(event);
        });
      }

    }
  });

}();

    </script>

  </body>
</html>
